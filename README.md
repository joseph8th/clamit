ClamIt
======

Simple commandline utility script to make the industrial-strength [ClamAV](http://clamav.net) antivirus software for mailservers easier to use from a Linux LiveCD or USB drive. Intended for Windows OS virus removal.

Basic Installation
------------------

1) Boot the target computer to a Linux LiveCD (or better yet, Ubuntu-based persisent USB). 

2) Install `git`, clone `clamit` from GitHub *into a hidden `~/.clamit` directory*:

    $ git clone https://github.com/joseph8th/clamit ~/.clamit
    
3) Make the shell script executable:

    $ cd ~/.clamit; chmod +x clamit

4) Install the `clamit` command into your `PATH` (so you don't have to be in the `~/.clamit` directory to run it):

    $ ./clamit install cmd

5) You can use `clamit` to install `clamav` if you use either the `aptitude` (Debian, Ubuntu, etc.) or `pacman` (Arch)
package managers (otherwise install `clamav` using your package manager, or from source):

    $ clamit install clam [-a | -p]

Advanced Installation
---------------------

* Update `clamit` from the repository using:

    $ clamit install update
    
* Install four useful `*.desktop` launchers to the current user's `Desktop` folder, if it exists. NOTE: this feature requires `gnome-terminal` to work, for now.

    $ clamit install launch
    
Usage
-----

    $ ./clamit {get [git | apt | pac], fresh, mount, scan [device | tree], clean [logfile]}

Commands
--------

    -h, --help		    print a help screen

    get [git | apt | pac]   update `clamit`, OR install `clamav` package with `aptitude` or `pacman`

    fresh             	    update virus databases

    mount		    choose and mount a device and all its partitions

    scan [device | tree]    mount and scan device or file tree; generates `clam.log` file

    clean [logfile]         process the log file generated by `scan` (remove, quarantine or ignore)

Tips for Windoze LUsers
-----------------------

I wrote this script for my employer, an old-school Windoze man who has been fairly amazed at the way I use Linux to cure
many of our clients' more serious infections, but didn't want to learn everything you need to know to use ClamAV. 

You will have to figure out how to: (a) make a Linux LiveCD/USB, and (b) open a terminal (`cmd.exe` on steroids). 
After that you can just use the installation instructions.

When you use the `scan` command, ClamIt will list all the available drives, and ask which *device* you want to use.
These are listed in *Linux* format: `/dev/sdX`, where 'X' is a letter 'a-z'. If the machine you booted has only one
drive, this will always be `/dev/sda`. If it has two, the second one will be `/dev/sdb`, etc. If the machine has any
card readers, these will be listed also, so some machines may have a lot of devices.

(If you doubt which device to scan, you can quit the program at any time by typing `^-C`. Then run the `lsblk` command
to get a tree view of all block devices connected to the machine. This is enough info to determine which is the correct 
device to choose.)

ClamIt will then mount all primary partitions of the chosen device in a single tree under `/mnt/clamit` and recursively
scan the data for viruses *including all Windows system files*. It tells ClamAV to store a log file containing the 
locations of all the infected files at the top of this tree. 

Then, when you run `clean`, it processes this log and asks if you want to remove, quarantine, or ignore each infected 
file. If you quarantine a file, ClamIt moves the infected files into a `clam-quarantine` directory in the root of the 
*target* machine's filesystem (i.e., 'C:\clam-quarantine'). If you want to restore the file, you will have to do so 
manually, as this feature has not yet been added to ClamIt.
